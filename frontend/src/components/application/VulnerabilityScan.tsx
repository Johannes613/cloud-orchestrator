// File: src/components/application/VulnerabilityScan.tsx
import React from 'react';
import { Box, Typography, Button, Paper } from '@mui/material';
import VulnerabilityTable from './VulnerabilityTable';

// Mock data for the vulnerability scan results
const vulnerabilities = [
    { file: 'Dockerfile', vulnerability: 'Outdated Base Image', severity: 'High', line: 1, description: 'The base image used in the Dockerfile is outdated and contains known vulnerabilities.', suggestion: 'Update to the latest stable version of the base image.' },
    { file: 'src/app.js', vulnerability: 'SQL Injection', severity: 'High', line: 45, description: 'Potential SQL Injection vulnerability in the database query.', suggestion: 'Use parameterized queries or an ORM to prevent SQL injection.' },
    { file: 'src/utils.py', vulnerability: 'Hardcoded API Key', severity: 'Medium', line: 12, description: 'The API key is hardcoded in the source code.', suggestion: 'Store API keys in environment variables or a secrets management system.' },
    { file: 'src/config.py', vulnerability: 'Insecure Default Password', severity: 'Medium', line: 20, description: 'The application uses an insecure default password.', suggestion: 'Require users to set a strong password during initial setup.' },
    { file: 'src/auth.py', vulnerability: 'Missing Input Validation', severity: 'Low', line: 30, description: 'Missing input validation for user-provided data.', suggestion: 'Implement input validation to prevent potential security issues.' },
];

const VulnerabilityScan = () => {
    return (
        <Box sx={{ p: 3 }}>
            <Box mb={4}>
                <Typography variant="h5" sx={{ fontWeight: 'bold' }} gutterBottom>
                    AI-Powered Vulnerability Scan Results
                </Typography>
                <Typography variant="body2" color="text.secondary">
                    Scan Summary: Identified 3 high-severity, 5 medium-severity, and 2 low-severity vulnerabilities in your application's Dockerfile and source code.
                </Typography>
                <Button variant="outlined" sx={{ mt: 2 }}>View Details</Button>
            </Box>

            <Paper sx={{ mb: 2 }}>
                <VulnerabilityTable data={vulnerabilities} />
            </Paper>

            <Box display="flex" justifyContent="flex-end">
                <Button variant="contained">Re-scan</Button>
            </Box>
        </Box>
    );
};

export default VulnerabilityScan;
